<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Welcome – English Voice Club</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="color-scheme" content="light dark">
  <link rel="stylesheet" href="login.css">
</head>

<body>
  <!-- Background decorative layers -->
  <div class="bg-layer layer-1"></div>
  <div class="bg-layer layer-2"></div>

  <!-- Card -->
  <main class="card">
    <div class="logo">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2z"/>
        <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
        <path d="M9 9h.01M15 9h.01"/>
      </svg>
      <h1>English Voice Club</h1>
    </div>

    <p class="subline">Join the weekly speaking challenge</p>

    <form id="authForm" novalidate>
      <label>
        <span class="label">Email</span>
        <input type="email" id="email" placeholder="you@example.com" required autocomplete="email">
      </label>

      <label>
        <span class="label">Password</span>
        <input type="password" id="pw" placeholder="••••••••" minlength="6" required autocomplete="current-password">
      </label>

      <label>
        <span class="label">Age group</span>
        <select id="cat" required>
          <option value="" disabled selected>Select category</option>
          <option value="under8">Under 8</option>
          <option value="8-13">8 – 13</option>
          <option value="13-17">13 – 17</option>
          <option value="18plus">18+</option>
        </select>
      </label>

      <button type="submit" class="btn-primary">
        <span class="btn-text">Create account / Login</span>
        <span class="spinner"></span>
      </button>

      <p id="error" role="alert" hidden></p>
    </form>

    <footer>
      <small>© 2025 English Voice Club</small>
    </footer>
  </main>

  <!-- Theme toggler -->
  <button id="themeToggle" aria-label="Toggle dark/light mode" title="Toggle theme">
    <svg class="sun" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
      <path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 6.34L4.93 4.93m12.73 12.73l1.41 1.41"/>
    </svg>
    <svg class="moon" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
      <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
    </svg>
  </button>

  <!-- Firebase logic (unchanged) -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js';
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js';
    import { getFirestore, doc, setDoc } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js';
    const firebaseConfig = {  apiKey: "AIzaSyCBG65IYMUSjzGqQPhysMcZjTNIw3h-5B4",
  authDomain: "englishlearningclubindia.firebaseapp.com",
  projectId: "englishlearningclubindia",
  storageBucket: "englishlearningclubindia.firebasestorage.app",
  messagingSenderId: "252611300228",
  appId: "1:252611300228:web:62ae9614f1e62e075f2bd1",
  measurementId: "G-57G30Y3GSP"};
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const form = document.getElementById('authForm');
    const errorBox = document.getElementById('error');
    const btnText = document.querySelector('.btn-text');
    const spinner = document.querySelector('.spinner');

    form.addEventListener('submit', async e => {
      e.preventDefault();
      errorBox.hidden = true;
      btnText.style.opacity = '0';
      spinner.style.opacity = '1';

      const { email, pw, cat } = form.elements;
      try {
        let cred;
        try { cred = await signInWithEmailAndPassword(auth, email.value, pw.value); }
        catch { cred = await createUserWithEmailAndPassword(auth, email.value, pw.value); }
        await setDoc(doc(db, 'users', cred.user.uid), { category: cat.value });
        location.href = 'dashboard.html';
      } catch (err) {
        btnText.style.opacity = '1';
        spinner.style.opacity = '0';
        errorBox.textContent = err.message;
        errorBox.hidden = false;
      }
    });
  </script>

  <!-- Theme toggle -->
  <script>
    const btn = document.getElementById('themeToggle');
    const html = document.documentElement;
    const stored = localStorage.getItem('theme');
    if (stored) html.classList.toggle('dark', stored === 'dark');
    btn.onclick = () => {
      const isDark = html.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    };
  </script>
</body>
</html>